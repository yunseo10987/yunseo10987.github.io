---
title: "[2025-07-07] SSTI, XXE, XML"
excerpt: "SSTI, XXE, XML ê°œë… ì •ë¦¬"

categories:
  - Justice
tags:
  - [SSTI, XXE, XML]

permalink: /Justice/[2025-07-07] SSTI, XXE, XML/

toc: true
toc_sticky: true

date: 2025-07-07
last_modified_at: 2025-07-07
---

## ğŸ¦¥ ë³¸ë¬¸

## SSTI

- Server Side Template Injection. Templateì„ ì•…ìš©í•˜ì—¬ Server Sideì—ì„œ ì•…ì˜ì ì¸ í•´ì„ì„ ìœ ë„

### Template

- ë™ì  ì›¹ í˜ì´ì§€ì— ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ ì˜ì—­ í˜¹ì€ í‹€
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image.png)
    
- {% raw %}{{}}{% endraw %}, {% raw %}{%%}{% endraw %}, ${}ì„ ë”°ë¥´ë©° ì´ëŠ” í…œí”Œë¦¿ ì—”ì§„ì— ë”°ë¼ ìƒì´
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy.png)
    

### ë™ì‘ íë¦„

1. í…œí”Œë¦¿ ì—”ì§„ì´ ì‚¬ìš©ì ì…ë ¥ì„ í…œí”Œë¦¿ ë¬¸ë²•ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ ì½”ë“œ êµ¬ì„±
2. ì•…ì„± ì‚¬ìš©ìê°€ {% raw %}{%code%}{% endraw %}, {{expression}}ì„ ì…ë ¥
3. ì„œë²„ê°€ code ë˜ëŠ” expressionì„ â€˜ì‹¤í–‰â€™í•˜ì—¬ì„œ ê²°ê³¼ë¥¼ HTMLë¡œ ëœë”ë§
4. ê³µê²©ìëŠ” code, expressionì„ í†µí•´ Server Sideì—ì„œ ì„œë²„ ëª…ë ¹ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆì„ ë¿ ì•„ë‹ˆë¼ ê²°ê³¼ë¥¼ ë°›ì•„ Interactë„ ê°€ëŠ¥
    
    â†’ ì£¼ë¡œ í…œí”Œë¦¿ ì—”ì§„ ë° SSTI ê³µê²© í™•ì¸ ì°¨ {% raw %}{{7*7}}{% endraw %} í˜¹ì€ {% raw %}{%7*7%}{% endraw %} ë“±ì˜ payloadë¥¼ ì‚¬ìš©. ë§Œì•½ 49ê°€ ê²°ê³¼ê°’ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤ë©´, í•´ë‹¹ ê°’ì„ Syntaxë¡œ ì¸ì‹í•˜ê³  ìˆë‹¤ëŠ” ê²ƒ.
    
- ì˜ˆì‹œ ì½”ë“œ

![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%202.png)

â†’ í˜¸ìŠ¤íŠ¸ì—ì„œ lsë¥¼ ì…ë ¥í•˜ëŠ” ì½”ë“œ. í…œí”Œë¦¿ ë¬¸ë²•ì„ í™•ì¸í•˜ëŠ” ê²Œ ì¢‹ìŒ.

## XXE

- XML eXternal Entity. External Entityë¥¼ Server Sideì—ì„œ ì¶œë ¥í•´ í¬í•¨ì‹œí‚¤ë„ë½ í•¨

### XML

- eXtensible Markup Language. ë°ì´í„°ë¥¼ êµ¬ì¡°í™”í•˜ê³  ì „ì†¡í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§„ ì–¸ì–´
- HTMLê³¼ ìœ ì‚¬í•˜ê²Œ ìƒê²¼ì§€ë§Œ ë°ì´í„° í‘œí˜„ ëª©ì ì— ë” ì í•©í•˜ë©° íƒœê·¸ë¥¼ ììœ ë¡­ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŒ
- ê¸°ë³¸ êµ¬ì¡°
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%203.png)
    
    - L1 : versionì€ 1ì´ê³  ë‚´ë¶€ ê°’ì€ UTF-8 ì¸ì½”ë”© í•´ì„
    - L2 : Userë¼ëŠ” ê°ì²´ ì•ˆì— name, emailì´ë¼ëŠ” ê°ì²´ê°€ ìˆê³  User.name = í™ê¸¸ë™, User.email = hongâ€¦.
- ì¶”ê°€ ê¸°ëŠ¥ : DTD(Doc. Type Definition)
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%204.png)
    
    - noteë¼ëŠ” ë°ì´í„° íƒ€ì… ì•ˆì—ëŠ” to, from, bodyê°€ ë“¤ì–´ê°€ì•¼ í•¨ì„ ì˜ë¯¸
    - to, from, bodyì— ëŒ€í•œ ë°ì´í„° íƒ€ì…ì„ PCDATA(Parshed Char Data(ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë§. ì¦‰ String ê°’))ì´ë¼ê³  ì •ì˜
- ì¶”ê°€ ê¸°ëŠ¥ : External Entity
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%205.png)
    
    - ì™¸ë¶€ì˜ íŒŒì¼ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥
    - dataë¼ëŠ” DTDì—ëŠ” secretì´ë¼ëŠ” ê°’ì€ â€œfile:â€¦.â€ì„ ë„£ì€ ë³€ìˆ˜ë¼ëŠ” ê²ƒì„ ì˜ë¯¸
    - í˜¸ì¶œ ì‹œì—ëŠ” ì•ì—ëŠ” & ë’¤ì—ëŠ” ;ì„ ë„£ì–´ì„œ í˜¸ì¶œ

### ì›ë¦¬

- ì˜ˆì‹œ
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%206.png)
    
    - xxe_payload ë¶€ë¶„ì„ ì‚¬ìš©ì ì…ë ¥ê°’ìœ¼ë¡œ í•œë‹¤ë©´ ì·¨ì•½ì  ë°œìƒ. ì¦‰, ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì´
    
    ```jsx
    <?xml version="1.0"?>
    <!DOCTYPE data [
      <!ENTITY xxe SYSTEM "file:///etc/passwd">
    ]>
    <data>&xxe;</data>
    ```
    
    ì´ì–´ì„œ ì›ì¹˜ ì•ŠëŠ” íŒŒì¼ì„ íŒŒì‹±í•˜ì—¬ ì¶œë ¥í•˜ê²Œ ë¨ 
    
    - XMLì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤, Jenkins, SSO Service ì·¨ì•½
    - XML Formatì˜ GPX, KML, OSM(ì§€í˜•, ìœ„ì¹˜ ì •ë³´ë¥¼ ë‹¤ë£¨ëŠ” íŒŒì¼ í˜•ì‹) ì·¨ì•½

### ë°©ì–´

![image.png](https://yunseo10987.github.io/assets/images/posts_img/[2025-07-07]%20SSTI,%20XXE,%20XML/image%20copy%207.png)

```jsx
parser.setFeature(feature_external_ges, False) 
```

- DTDë¥¼ ë§‰ê³  ë‚´ë¶€ì ìœ¼ë¡œ ì„ ì–¸í•œ DTDë¡œë§Œ íŒŒì¼ í˜•ì‹ ì •ì˜
- ì™¸ë¶€ íŒŒì¼ì„ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” DTD ë¹„í™œì„±í™”

### ì¶”ê°€ ìë£Œ

[https://www.igloo.co.kr/security-information/ì›¹-í…œí”Œë¦¿-ì—”ì§„-ê¸°ë°˜ì˜-ssti-ì·¨ì•½ì -ë¶„ì„/](https://www.igloo.co.kr/security-information/%EC%9B%B9-%ED%85%9C%ED%94%8C%EB%A6%BF-%EC%97%94%EC%A7%84-%EA%B8%B0%EB%B0%98%EC%9D%98-ssti-%EC%B7%A8%EC%95%BD%EC%A0%90-%EB%B6%84%EC%84%9D/)

