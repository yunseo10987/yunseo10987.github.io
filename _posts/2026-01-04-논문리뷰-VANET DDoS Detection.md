---
title: "[2026-01-04] DDos Detection Mechanism Using Trust-Based"
excerpt: "VANET DDoS with DSRC"

categories:
  - Reviews
tags:
  - [NetWork]

permalink: /Reviews/[2026-01-04] Evaluation System in VANET/

toc: true
toc_sticky: true

date: 2026-01-04
last_modified_at: 2026-01-04
---

## 🦥 본문

## Background

### VANET

무선 네트워크를 사용하여 RSU(도로변 기지국) 또는 도로 인프라를 통해 인접 차량 간의 통신이 이루어지는 인프라 구조

- 짧은 시간 동안 통신 수립/해제되기 때문에 동적.
- 이미 건설된 고속도로 및 도로를 통한 차량의 패턴 같은 예측 가능한 부분이 있지만 운전자의 행동, 지역, 인구, 시간대 등 불확실한 부분도 있음
- 각 노드들은 서로 다른 RSU로부터 데이터를 받고 multi-hop이 발생.
    - multi-hop 같은 경우 여러 노드 중 하나의 노드만 점령돼도 과부화
    - 하나의 패킷이 여러 노드를 거치므로 해당 노드들의 자원 소모 유발
        
        → DoS, DDoS에 취약  
        

### DSRC

- 시간 분할 구조 : 여러 채널과의 통신을 위해 시간을 일정 단위로 나눔
    - Sync Period : 100ms 단위로 시간 분할
    - CCH Interval : 주기의 전반부 50ms 동안은 모든 기기가 CCH(제어 채널)에 접속하여 WSA 등을 주고 받음
    - SCH Interval : 주기의 후반부 50ms 동안은 서비스 채널로 이동하여 일반 데이터 교환
    - Guard Interval : CCH, SSH 시작점에 4ms의 보호 구간. 주파수 전환 및 설정 변경. 수신은 가능하지만 송신은 안함
    - 시간 슬롯
        - Backoff : 채널이 사용 중일 경우, 무작위로 선택된 수의 유휴 시간 슬롯만큼 기다린 후 전송 시작
        - Backoff 슬롯이 겹칠 때, 동기화된 충돌이 발생할 수 있으므로 무작위 전송 시점이 중요

## Related Works

**DSRC & revocation** 

공격자가 슬롯을 차지하기 위해 슬롯 시간을 변경하면서 노드와 통신. 우선순위 순으로 클래스 1~4 존재. 클래스 1~2는 안전 정보 전달. 클래스 3~4는 상업용 메시지 전달.

주어진 시간 동안 제안된 수의 안전 정보 수신

**Traffic capacity and Bloom**

IP spoofing 방지. 

1. 데이터 수집 및 분류
2. 데이터를 통해 악성 노드의 존재 여부 확인 및 DB에 저장
    - IP-CHOCK 알고리즘을 통해 IP 주소와 차량의 위치를 대조
3. 해시 함수를 통해 Bloom Filter 절차 수반
    - 공격자의 IP를 해시 함수를 통해 Bloom Filter에 등록함.
    - 이후로 필터에 걸리는 패킷은 차단. 필터에 걸리는 경우 알람을 울리고 패킷 폐기. VANET 내 모든 노드에 해당 정보를 전송

**공격 탐지 알고리즘**

- APDA : 위치, 신호 세기, 속도, timestamp 등을 취득하여 악성 노드 인식.
    - 악성 노드가 시간 슬롯과 ID를 바꿔도 물리적인 전파 신호는 같음
    - 확증 단계(고비용) 이전에 악성 노드를 식별하여 오버 헤드를 최소화. 즉, 물리적 대조만으로 검사하여 저비용으로 가능.
- MVND : 하이브리드 네트워크를 적용하여 검증 시간 이전에 악성 노드 확정.

**신뢰 관리 방식**

- 신뢰 평가 모델
    - 정책 제어 : 진입 신뢰와 데이터 신뢰
    - 능동적 신뢰 : 노드 차량의 과거 통신 이력
    - 소셜 신뢰 : 인접한 이웃 차량 평가를 고려하여 다른 차량의 신뢰 설정
- 와치독 알고리즘
    - Relay node들이 패킷을 제대로 전달하는 지 모니터링, 신뢰값 측정 후 신뢰 테이블에 저장.
    - 높은 신뢰도의 차량과 통신
    - 한계 : 네트워크 충돌을 유발. 모니터링 이력이 방대하여 확장성이 낮음
- Crowd Sourcing
    - 차량 간 사고 보고를 통해 신뢰성 측정
    - 개별 차량이 broadcast하는 신뢰값을 전역뷰에서 평가
    - 고유 ID와 공개 키 기반 구조(PKI)를 포함하여 보안 강화가 필요
- Trust Token
    - 협력을 통해 동적으로 토큰을 생성
    - 대칭 및 비대칭 접근 방식의 암호화 매커니즘과 이웃 와치독 알고리즘을 통해 패킷의 유효성 검사

## 문제 정의

Flooding 공격을 통한 자원 고갈 DDoS  공격으로 분산적이라 추적이 힘듦

- V2V : 서로 다른 위치에 있는 공격자들이 타임 슬롯을 사용하여 flooding.
- V2I  RSU에 flooding. 공격 도구들을 쉽게 구할 수 있고 자동화된 공격 가능. 네트워크에서 Denial 공격 수행

## 신뢰 기반 프레임워크

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image.png)

**신뢰 평가 매커니즘**

신뢰 : 여러 상호 작용에서 신뢰할 수 있는 지 파악되는 정도. 계층적 트리 내에서 노드의 위치 결정

신뢰 알고리즘들을 신뢰할 수 있는 경로를 식별하는 역할. 

신뢰 평가와 클러스터링을 통해 모니터링 효율적, 안전, 패킷 전달률(PDR) 향상. 에너지 소비(EC) 최적화. 확장성 및 가용성

**동작 흐름**

1. 초기화 : 노드 파악, 초기 설정
2. 신뢰 평가 
    1. 신뢰 가설 통계 : 과거 통신 성실도 수치화.
        - 전송 추적 알고리즘 : 신뢰 구성 요소를 수치화하는 데 사용
            - Input : 통신 데이터
            - Output : 전송 패킷
            - Send_packets()로 패킷 전송을 시작하며, 이 과정에서 전송 이력 기록
        - 가설 통계 알고리즘 : 경험 통계값을 수치화
            - Input : 전송 기록
            - Output : 가설 통계
            - 전송 성공 시 가설 값 1 증가. 실패 시 1 감소.
            - $HY(i, j) = \frac{S(i, j) - G(i, j)}{S(i, j)}$으로 S(i, j)는 전체 통신 횟수, G(i,j)는 통신 실패 횟수.
    2. 주행 빈도 통계  : 특정 시점에서 데이터가 성공적으로 전송된 최고 빈도. 높은 빈도로 데이터를 브로드캐스트하는 노드 식별   
        - 알고리즘
            - Input : 전송 추적 데이터
            - Output : 주행 빈도 통계값
            - 전송 성공 시 주행 빈도 값을 1 증가. 지연이 발생하면 가설 신뢰 값을 1 감소
            - $FV_{(i,j)} = \frac{P_{(i,j)}}{T}$.
                - **$P_{(i,j)}$** : 노드 $i, j$ 간의 성공적인 데이터 전송 횟수
                - $T$ : 관찰 시간
    3. 데이터 요인 : 두 노드 사이의 패킷이 브로드캐스트 되거나 분실되거나 수신될 가능성을 분석
        - 알고리즘
            - Input : 전송 기록
            - Output : 데이터 요인
            - 전송 시작 후 전체 패킷 수 계산. 성공적으로 전송된 패킷 수 카운트
            - $DF(i,j) = \frac{Tot_{ps} - Tot_{lst}}{Tot_{ps}}$.
                - $Tot_{ps}$ : 전체 패킷 수
                - $Tot_{lst}$ : 손실된 패킷 수
    4. 클러스터 분리 
        - 신뢰 분석 수행 후 보로노이 집합(Voronoi set) 형성
        - 유전 알고리즘 & DGSOT
            - 수직/수평 성장
                - 수직적 성장 : 이질성이 임계값보다 높을 때 리프 노드 추가.
                    
                    새로운 리프 노드들의 참조 벡터 초기화 & HGF true로 설정. winner 찾고 이웃 노드들의 참조 벡터 업데이트 
                    
                - 수평적 성장 : 이질성이 임계값보다 작을 때 최하위 레벨의 서브 클러스터 개수를 최적으로 계산
                    
                    최하위 노드에서 시작. 수평적 성장 규칙이 만족되지 않으면 HGF를 true로 하고 자식노드를 추가하여 옆으로 늘림.
                    
                    winner 노드를 찾고 이웃들의 참조 벡터 업데이트  
                    
                - 이질성 : 주행 빈도와 엔트로피로부터 얻은 점수의 편차를 통해 계산
            - DGSOT : 동적으로 성장하는 자기 조직화 트리. 계층적 트리 구조를 찾는 데 활용
        - 클러스터 분리 : 두 중심점 사이의 최솟값 대비 최댓값 비율. 최적의 클러스터 수를 달성하고 모니터링 효율을 높임
        - 신뢰 평가 행렬 : 데이터 베이스의 역할. 각 노드들의 신뢰 평가에 사용되는 정보 저장.
        - 알고리즘
            - Input : 신뢰값
            - Output : 클러스터 트리
            1. 초기화
                1. 루트 노드 생성 후 참조 벡터 초기화. 참조 벡터 값은신뢰 데이터의 중심점으로 설정.  4
                2. 네트워크 내의 모든 데이터를 루트 노드에 할당
                3. HGF를 true로 설정.  
            2. 수평적 성장 flag(HGF)가 true인 경우. 수평 성장. 각 차량의 IP 주소를 시스템 내의 관련 신뢰 데이터와 결합
            3. 수직적 성장 flag가 false인 경우. 이질성이 임계점보다 큰 경우(→ 신뢰도 차이가 크다는 뜻) 수직 성장. HGF 값을 설정 후 이웃 시스템의 IP 정보 업데이트. 
            4. 수평적 성장 중단 규칙이 만족되지 않은 경우 HGF를 true로 만들고 아니면 false로 설정. 
            5. Winner node와 그 이웃들의 참조 벡터를 업데이트 → 클러스터 헤더를 최신 상태로 유지
            6. 모든 하위 레벨의 HGF가 임계값보다 작아지면 알고리즘 종료 → 모든 노드가 자신과 비슷한 신뢰도를 가진 그룹에 속한다는 뜻 
    - 기본은 직접 관찰이지만 상호 작용이 없는 노드 사이의 신뢰를 확정하기 위해서는 relay node들의 간접 정보가 필요
3. 가설 수용 여부 판별
4. 신뢰 정책 : 최대 신뢰 지수를 보유한 클러스터를 통해 우세 클러스터 식별.
    - 알고리즘
        
        모든 계층적 수준에서 검사. 가설, 메시지 정확성, 잔여 에너지를 통해 신뢰값을 평가하고 최대 신뢰 지수를 보유한 클러스터가 우세 클러스터가 됨. 
        
    - 우세 클러스터 : 신뢰할 수 있는 노드들. 라우팅에 참여 가능. 안전하고 가장 높은 Throughput 보장
    1. 수직/수평 성장   
    2. 참조 벡터 업데이트   

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-1.png)

1. 초기화
2. 루트 노드 생성, 전체 신뢰 데이터의 중심점으로 참조 벡터 설정. `HGF = true`로 설정
3. 수직 성장
4. 이질성이 임계값보다 크다면 두 자식 노드를 생성
5. 생성한 노드의 참조 벡터를 초기화하고 `HGF = true`로 설정
6. 학습 프로세스 
7. 수평적 성장
8. 최하위 레벨에서 중단 규칙이 만족되지 않고 `HGF = true`인 경우, 자식 리프를 추가한 후 학습
9. 아닌 경우에는 노드에서 자식 삭제 및 `HGF = false`로 설정 후 학습
10. Winner 노드 찾고 해당 노드와 그 이웃 노드들의 참조 벡터 업데이트  

## 구현 및 결과

우분투 환경에서 NS-2.28을 기반으로 한 시뮬레이션 모델. 

T1 : 일반적인 AODV 체계, T2 : FIRECOL, T3 : 신뢰 기반 프레임 워크 

**T1**

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-2.png)

네트워크 규모 50, 100, 150, 200에서 실행했고 악성 노드가 포함될 경우, 드롭된 패킷은 9700~9997개 정도.

**T2**

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-3.png)

규모가 커질 수록 라우팅된 패킷 수가 증가하고 드롭된 패킷수도 감소

**T3**

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-4.png)

규모가 커질 수록 라우팅된 패킷 수가 증가하고 드롭된 패킷수도 감소. 기존 방법에 비해 PDR이 향상됨

- 평균 지연 시간
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-5.png)
    
- DR(탐지율)
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-6.png)
    
- 에너지 소비
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2026-01-04%20VAMET%20DDoS/image-7.png)
    

### 궁금한 점

공격으로 인해 지연 시간 90초 → 30초로 줄였지만 내 생각에는 네트워크 내에서 그 정도의 latency면 엄청 큰 거 아닌가??? 그것도 VANNET은 차량이 왔다 갔다 하는 데 

공격의 방법이나 악성 노드의 수나 비율을 알 수 없어서 아쉽다.