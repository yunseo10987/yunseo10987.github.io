---
title: "[2025-07-08] File-Download-1"
excerpt: "File-Download-1"

categories:
  - Problem
tags:
  - [SSTI]

permalink: /Problem/[2025-07-08] File-Download-1/

toc: true
toc_sticky: true

date: 2025-07-08
last_modified_at: 2025-07-08
---

## ğŸ¦¥ ë³¸ë¬¸

## File-download-1

```python
#!/usr/bin/env python3
import os
import shutil

from flask import Flask, request, render_template, redirect

from flag import FLAG

APP = Flask(__name__)

UPLOAD_DIR = 'uploads'

@APP.route('/')
def index():
    files = os.listdir(UPLOAD_DIR)
    return render_template('index.html', files=files)

@APP.route('/upload', methods=['GET', 'POST'])
def upload_memo():
    if request.method == 'POST':
        filename = request.form.get('filename')
        content = request.form.get('content').encode('utf-8')

        if filename.find('..') != -1:
            return render_template('upload_result.html', data='bad characters,,')

        with open(f'{UPLOAD_DIR}/{filename}', 'wb') as f:
            f.write(content)

        return redirect('/')

    return render_template('upload.html')

@APP.route('/read')
def read_memo():
    error = False
    data = b''

    filename = request.args.get('name', '')

    try:
        with open(f'{UPLOAD_DIR}/{filename}', 'rb') as f:
            data = f.read()
    except (IsADirectoryError, FileNotFoundError):
        error = True

    return render_template('read.html',
                           filename=filename,
                           content=data.decode('utf-8'),
                           error=error)

if __name__ == '__main__':
    if os.path.exists(UPLOAD_DIR):
        shutil.rmtree(UPLOAD_DIR)

    os.mkdir(UPLOAD_DIR)

    APP.run(host='0.0.0.0', port=8000)

```

ìœ„ì™€ ê°™ì€ ì½”ë“œë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ì—…ë¡œë“œë¥¼ í•  ë•Œì—ëŠ” íŒŒì¼ëª…ì„ í•„í„°ë§í•˜ì—¬ ìƒëŒ€ ê²½ë¡œë¥¼ í†µí•´ flag.pyì— ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë§‰ì•„ë†¨ë‹¤. ì—…ë¡œë“œë¥¼ í•˜ë©´ /read APIì— ì ‘ê·¼í•˜ì—¬ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆê²Œ ëœë‹¤. í•´ë‹¹ /read APIëŠ” get ë°©ì‹ìœ¼ë¡œ íŒŒì¼ëª…ì„ ë°›ì•„ íŒŒì¼ì„ ì½ì–´ì˜¤ëŠ”ë°, í•„í„°ë§ì„ í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ../flag.pyë¥¼ í•˜ê²Œ ë˜ë©´ FLAGë¥¼ ì–»ì„ ìˆ˜ ìˆê²Œ ëœë‹¤.