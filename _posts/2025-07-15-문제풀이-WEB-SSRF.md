---
title: "[2025-07-15] Web-SSRF"
excerpt: "SSRF"

categories:
  - Problem
tags:
  - [SSRF]

permalink: /Problem/[2025-07-15] Web-SSRF/

toc: true
toc_sticky: true

date: 2025-07-15
last_modified_at: 2025-07-15
---

## ğŸ¦¥ ë³¸ë¬¸

```c
#!/usr/bin/python3
from flask import (
    Flask,
    request,
    render_template
)
import http.server
import threading
import requests
import os, random, base64
from urllib.parse import urlparse

app = Flask(__name__)
app.secret_key = os.urandom(32)

try:
    FLAG = open("./flag.txt", "r").read()  # Flag is here!!
except:
    FLAG = "[**FLAG**]"

@app.route("/")
def index():
    return render_template("index.html")

@app.route("/img_viewer", methods=["GET", "POST"])
def img_viewer():
    if request.method == "GET":
        return render_template("img_viewer.html")
    elif request.method == "POST":
        url = request.form.get("url", "")
        urlp = urlparse(url)
        if url[0] == "/":
            url = "http://localhost:8000" + url
        elif ("localhost" in urlp.netloc) or ("127.0.0.1" in urlp.netloc):
            data = open("error.png", "rb").read()
            img = base64.b64encode(data).decode("utf8")
            return render_template("img_viewer.html", img=img)
        try:
            data = requests.get(url, timeout=3).content
            img = base64.b64encode(data).decode("utf8")
        except:
            data = open("error.png", "rb").read()
            img = base64.b64encode(data).decode("utf8")
        return render_template("img_viewer.html", img=img)

local_host = "127.0.0.1"
local_port = random.randint(1500, 1800)
local_server = http.server.HTTPServer(
    (local_host, local_port), http.server.SimpleHTTPRequestHandler
)

def run_local_server():
    local_server.serve_forever()

threading._start_new_thread(run_local_server, ())

app.run(host="0.0.0.0", port=8000, threaded=True)

```

- ì½”ë“œë§Œ ë´ì„œëŠ” FLAGë¥¼ ëª°ëì§€ë§Œ ê°™ì€ íŒŒì¼ì— flag.txtê°€ ìˆëŠ” ê±¸ ë³´ê³  ssrf ë°©ì‹ìœ¼ë¡œ ë°±ì—”ë“œì—ì„œ flag.txtì— ì ‘ê·¼í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤.

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-07-15%20web-ssrf/image.png)

- static/dream.pngëŠ” ì˜ ì ‘ê·¼ë˜ëŠ” ë° flag.txtëŠ” ì ‘ê·¼ì´ ì•ˆë¼ì„œ ì˜ë¬¸ì´ì—ˆë‹¤.
- ê·¸ë˜ì„œ ì°¾ì•„ë³´ë‹ˆ static í´ë”ëŠ” 8000 í¬íŠ¸ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ì§€ë§Œ flag.txtëŠ” ë‚´ë¶€ë§ì„ í†µí•´ì„œ ì ‘ê·¼í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ë‹¤. 1500~1800 í¬íŠ¸ë¡œ ì ‘ê·¼í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë©´ ìœ„ì˜ elif ì½”ë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë° ipì£¼ì†Œ í•„í„°ë§ì„ íšŒí”¼í•˜ë ¤ë©´ ëŒ€ë¬¸ìë¥¼ ì“°ë©´ ëœë‹¤ëŠ” ê²ƒì´ë‹¤.
- 1500~1800 í¬íŠ¸ ì¤‘ ëœë¤ì´ë¼ ë¬´ì°¨ë³„ ê³µê²©ì„ í•´ì•¼ í•œë‹¤ê³  í•œë‹¤.

### í’€ì´

- burf suiteë¥¼ ì‚¬ìš©í–ˆë‹¤.
- í¬íŠ¸ë¥¼ 1500-1800ê¹Œì§€ ë³´ë‚´ì—ˆë‹¤.

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-07-15%20web-ssrf/image-1.png)

lengthê°€ ë‹¤ë¥¸ í¬íŠ¸ëŠ” 1543ì´ì—ˆë‹¤. responseë¥¼ í™•ì¸í•˜ë‹ˆ

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-07-15%20web-ssrf/image-2.png)

srcì— ë‹¤ë¥¸ ê°’ì´ ë“¤ì–´ìˆì—ˆê³  ì´ë¥¼ ë””ì½”ë”©í•˜ë‹ˆ flagë¥¼ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.