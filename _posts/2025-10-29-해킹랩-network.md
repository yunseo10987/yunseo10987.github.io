---
title: "[2025-10-29] 네트워크 해킹"
excerpt: "유선 네트워크 해킹"

categories:
  - Lab
tags:
  - [NetWork]

permalink: /Lab/[2025-10-29] 네트워크 해킹/

toc: true
toc_sticky: true

date: 2025-10-29
last_modified_at: 2025-10-29
---

## 🦥 본문

## 와이어샤크를 이용한 패킷 캡처

### 와이어 샤크 설치

```bash
sudo apt install wireshark
```

### promiscuous 모드 설정

패킷 캡처하기 위해 네트워크 어댑터를 promiscuous 모드로 설정해야 함. 

[와이어샤크 메뉴] - [Capture] - [Option]에서 enable promiscuous 모드로 설정했는 지 확인 

### 시작 및 캡처

- 기본 사용법 : 프로그램 표시에서 실행 또는 다음 코드 터미널에 입력

```bash
wireshark
```

- 오류 표시 무시 : 보안 상의 이유로 오류 창이 나오는 경우 다음과 같이 파일 변경

```bash
/user/share/wireshark/init.lua

disable_lua = true4
```

- 캡처 시작
    
    [Capture] - [Options]에서 캡처할 네트워크 어댑터 eth1 선택. 캡처 진행 후 파이어폭스를 들어가면 다음과 같은 화면이 나옴
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image.png)
    
    - 패킷  필터링
        
        HTTP 패킷 살펴보기 : filter에서 http를 넣어서 http 패킷을 확인
        
        OSCP는 공개키 증명서의 실효 상태를 취득하기 위한 통신 프로토콜, POST 메소드 사용 
        
        `http.request.method == ‘GET’`을 통해 GET 메소드만 필터링 가능 
        
    - 표시 필터 구문
        
        
        | **필터 구문** | **설명** |
        | --- | --- |
        | `http.request` | 모든 HTTP 요청(GET, POST 등) 패킷 표시 |
        | `http.response.code == 404` | HTTP 404 응답 코드 패킷 표시 |
        | `tcp.flags.reset == 1` | 모든 TCP RST(재설정) 플래그가 설정된 패킷 표시 (연결 종료/강제 종료 시 확인) |
        | `tcp.flags.syn == 1 && tcp.flags.ack == 0` | 모든 SYN 패킷 표시 (TCP 3-way-handshake의 첫 단계) |
        | `data` | 페이로드(Payload)에 데이터가 포함된 패킷 표시 (ARP, ICMP 등 제어 프로토콜 제외) |
        | `frame.len > 100` | 전체 프레임 길이가 100바이트를 초과하는 패킷 표시 |
        
        | **종류** | **필터 구문** | **설명** |
        | --- | --- | --- |
        | **특정 IP 주소** | `ip.addr == 192.168.1.100` | 출발지 또는 목적지가 해당 IP인 패킷 표시 |
        | **출발지 IP** | `ip.src == 192.168.1.100` | 출발지 IP가 해당 IP인 패킷만 표시 |
        | **목적지 IP** | `ip.dst == 192.168.1.100` | 목적지 IP가 해당 IP인 패킷만 표시 |
        | **서브넷 필터링** | `ip.addr == 192.168.1.0/24` | 해당 서브넷에 속하는 모든 IP 주소 표시 |
        | **특정 MAC 주소** | `eth.addr == 00:11:22:33:44:55` | 출발지 또는 목적지 MAC 주소가 일치하는 패킷 표시 |
    - 캡처 필터
        
        [Capture] - [Capture filters]에서 적용하고 싶은 캡처 필터를 선택. [+] 추가를 통해 원하는 필터 선택
        
        | **목적** | **캡처 필터 구문** | **설명** |
        | --- | --- | --- |
        | **특정 호스트** | `host 192.168.1.100` | IP 주소가 `192.168.1.100`인 호스트와 관련된 모든 트래픽 캡처 |
        | **특정 포트** | `port 80` | 출발지 또는 목적지 포트가 80인 모든 트래픽 캡처 (HTTP) |
        | **특정 프로토콜** | `tcp` | 모든 TCP 트래픽만 캡처 |
        | **출발지 주소** | `src host 10.0.0.5` | 출발지 IP가 `10.0.0.5`인 트래픽만 캡처 |
        | **목적지 포트** | `dst port 22` | 목적지 포트가 22인 트래픽만 캡처 (SSH) |
        | **특정 MAC 주소** | `ether host 00:11:22:33:44:55` | 해당 MAC 주소와 관련된 모든 트래픽 캡처 |

### 패킷 저장

[File] - [Save as]에서 pcapng 형식으로 캡처 데이터 저장. 

- 데이터  확인
    
    [File] - [Export Packet Dissections] - [As Plain Text]를 선택하여 텍스트 형식으로 내보낼 수 있음 
    
- 스트림 보기
    
    [Analyze] - [Follow]에 [TCP Stream], [UDP Stream] 등이 있음. 원하는 패킷을 선택하여 해당 버튼을 클릭하면 일련의 데이터를 연속해서 보여줌
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-1.png)
    
- 파일 데이터 스트림 추출
    1. 직접 추출 : ftp-data를 통해 패킷 필터링. RAW 파일로 저장하는 데 이때 ASCII로 확인할 때 파일 헤더에 MZ라면 확장자를 exe로 지정하는 것이 좋음. 
    2. NetworkMiner 이용 :  pcap 파일을 읽어 들이면 자동으로 파일 식별하여 추출
        1. 사이트에서 NetworkMiner 다운로드 
        2. `unzip networkminer-x` 으로 압축 풀기
        3. NetworkMiner 실행
            
            ```bash
            sudo apt update
            sudo apt install mono-complete 
            
            mono NetworkMiner.exe
            ```
            
    
    이 때 pcappng 파일은 editcap을 통해서 pcap 파일로 분할할 수 있다
    

### 캡쳐 파일 분석: Xplico

- Xplico 설치

```bash
sudo apt install xplico -y
```

- Xplico 웹 페이지 기동 : 설치 완료 시 웹 관리 페이지가 만들어짐. 다음 명령어를 입력하여 아파치를 다시 시작

```bash
sudo service apache2 restart
```

[`http://localhost:9876/`](http://localhost:9876/dp)에 들어가면 다음과 같이 서비스가 시작되지 않았다는 문구가 나옴

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-2.png)

- 서비스 기동

```bash
/etc/init.d/xplico start
```

- 로그인 : 해당 페이지에 다시 접속하면 로그인 화면이 나옴.
    - admin : {admin, xplico}
    - user : {xplico, xplico}
- 캡쳐 해독 : Case를 만들고 Case내에 여러가지 Session을 만들어 패킷을 분석하고 결과를 표현하도록 만들어짐. Case를 만드는 방법은 **캡처 파일 해독**과 **실시간 캡처 해독**으로 나눠짐
    - [왼쪽 메뉴] - [New case]에서 **DATA ACQUISITION(데이터 해독)**을 선택.
        
        Uploading PCAP capture file/s 이 캡처 파일 해독(파일 지정), Live acquisition이 실시간 해독(인터페이스 지정)
        
        캡쳐 파일 해독을 위해서는 전자를 선택하고 이름과 외부 레퍼런스 입력. 
        
    - 생성된 Case의 Name을 클릭하면 [Session]과 [New Session] 메뉴 생성. [New Session]을 클릭하여 세션 생성. 생성된 세션의 이름을 클릭하면 `Pcap set`에서 [Browse] 버튼을 클릭하여 패킷을 선택해서 업로드할 수 있음
    - [Web] - [https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/Image]에서 캡쳐된 패킷 파일에 포함된 그림 파일을 확인 가능

### 덤프 도구로 데이터 확인

와이어샤크에서는 Flow TCP Stream 화면에서 Hex Dump로 전환하여 덤프 확인

xxd 도구를 통해서도 내용 확인 가능

### nmap의 포트 스캔 분석

nmap을 이용해 TCP SYN 스캔, FIN 스캔, ACK 스캔 등 다양하게 가능 

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-3.png)

1. 백그라운드에서 캡쳐 시작 : eht0으로 지정

```bash
wireshark &
```

1. TCP full connection 스캔 확인 : nmap의 TCP full connection 스캔 확인
    
    ```bash
    nmap -sT -p 445 10.0.0.1
    //-sT는 TCP Connect Scan. 3way handshake를 완전히 수행하여 포트 상태 확인
    ```
    
    - 와이어샤크에서 ip.addr == 10.0.0.1을 필터링하여 패킷 확인
        
        ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-4.png)
        
    - [Statistics] - [Flow Graph]를 선택하면 통신 교환 내용을 쉽게 확인
        1. 다음과 같이 연결이 안되는 경우 방화벽 확인 
        
        ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-5.png)
        
        ```bash
        telnet 10.0.0.1 445
        ```
        
        - 인바운드 규칙 설정
            
            파일 및 프린터 공유(SMB-In) 규칙 사용으로 변경
            
            ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-6.png)
            
2. TCP SYN 스캔 확인 
    
    ```bash
    nmap -sS -p 445 10.0.0.1
    ```
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-29%20network/image-7.png)
    
    ACK를 안받고 RST를 보내기 때문에 더 빠름.