---
title: "[2025-10-28] Understanding the Mirai Botnet"
excerpt: "IoT Security"

categories:
  - Reviews
tags:
  - [NetWork]

permalink: /Reviews/[2025-10-28] Understanding the Mirai Botnet/

toc: true
toc_sticky: true

date: 2025-10-28
last_modified_at: 2025-10-28
---

## 🦥 본문

### 초록

임베디드와 IoT 장치로 구성된 Mirai botnet 디도스 공격으로 2016년 인터넷을 강타함. 어떻게 출현했는 지 어떤 종류의 장치들이 영향을 받았는지 어떻게 진화했는 지 분석. 초보적인 악성 기술로도 충분히 많은 저사양장치들을 감염시켜 가장 잘 방어되는 표적들조차 위협할 수 있음을 보여줌  

## Introduction

2016년 Mirai 봇넷을 통해 큰 디도스 공격이 일어남.  여러 요인의 조합이 작용. (인터넷 전체를 스캔하는 효율적인 확산 방식, IoT 제품에서 만연한 안전하지 않은 비밀번호 사용. 봇넷의 동작을 단순하게 유지하면 다양한 장치들을 감염시킬 수 있다는 통찰력). 그리고 다양한 변종이 나옴

다양한 관측 지점에서 데이터를 수집하고 이런 데이터 셋으로 기술적 비기술적 방어책을 제시 

이 봇들은 20시간만에 65000대의 IoT를 감염시키고 그 후 20~30만 건의 감염이라는 steady state에 도달. 이 봇들은 제한된 지리적 지역과 AS(자율 시스템 : 하나의 관리 주체에 의해 독립적으로 운영되는 라우터 및 네트워크 집단)에 집중. DVR, IP 카메라, 라우터, 프린터 등을 표적으로 삼았지만 미라이의 최종 장치 구성은 소수의 가전제품 제조사의 시장 점유율과 설계 결정에 강하게 영향 

변종들은 미라이의 탐지 회피 기술을 개선하고 새로운 IoT 장치 표적을 추가하며 추가적인 DNS Resilience를 도입하려고 시도했고 여러 유명한 업체들을 공격했음을 확인 

공격 역시 디도스가 주 악용 방식이었지만 라우터를 광고 사기, 카메라 갈취, 네트워크 연결 장치(NAS)를 비트코인 채굴 등에 악용 가능. 영향력은 국경과 법적 관할권을 넘어 확장. 보안 패치를 효과적으로 적용할 인프라가 거의 없는 장치들을 감염 

데스크톱에서의 보안 규칙들이 IoT에는 적용되지 않음. IoT는 자동 업데이트의 복잡성, 짧은 수명 주기, 보안 위험 알림이 힘듦 등으로 어려움 → 아직까지 남아있는 문제들임.

## Mirai Botnet

IoT 기기를 감염 시켜 DDoS 공격에 동원하는 worm-형태(다른 파일에 기생하는 바이러스와 달리 독립적인 프로그램. 사용자의 개입 없이 자체적인 복제 및 전파 능력을 가짐. 자체 복사 및 전파. 그리고 해당 복제 및 전파로 네트워크 부하. 악성 행위 수행 가능)의 악성 코드 패밀리

### Timeline


2016-08-31에 Miari에 대한 보고. 9월 중순에 Krebs와 OVH를 표적으로 한 대규모 DDoS 공격을 시작으로 추가 공격. 2017년에 Mirai 작성자의 신원 확인  

소스코드의 공개로 인해 미라이 변종들의 확산. 우리는 측정 방법론을 개발 

변종 중에 CPE WAN 관리 프로토콜(CWMP)를 통한 라우터 취약점 공격 지원을 추가. CWMP는 가정용 라우터, 모뎀 및 기타 고객 장비의 자동 구성 및 원격 관리를 가능하게 하는 HTTP 기반 프로토콜 

도이치 텔레콤에서 서비스 중단. 2월에 용의자 체포  

### structure & propagation


1. 스캔 : 비동기적이며, stateless한 스캐닝 단계. 하드 코딩(소스 코드 안에 특정 데이터나 설정값을 직접 고정시켜 넣었다는 의미)된 블랙리스트에 없는 유사 난수 IPv4 주소들을 대상으로 텔넷 TCP/23, TCP/2323에 TCP SYN 프로브를 전송. 잠재적인 피해자를 식별하면 무작위 대입 로그인 단계에 진입하여 미리 설정된 62개의 인증 정보 목록에서 무작위로 선택된 10쌍의 사용자 이름 및 암호를 사용하여 텔넷 연결 시도. 
2. 로그인에 성공하면 미라이는 피해자 IP와 관련 인증 정보를 하드 코딩된 보고 서버로 전송 
3. 로더 프로그램은 취약한 장치에 로그인하고 아키텍쳐를 파악
4. 아키텍쳐별 악성 코드를 다운하여 실행하여 비동기적으로 감염. 다운된 바이너리 파일을 삭제하고 프로세스 이름을 유사난수 영숫자 문자열로 난독화하여 자신의 존재를 숨김. → 재부팅되면 악성코드가 사라짐. TCP/22 또는 TCP/23에 바인딩된 다른 프로세스, 다른 미라이 변종 등 경쟁 악성 코드 감염과 관련된 프로세스들도 종료하여 강화. 봇은 공격 명령을 기달리면서 새로운 피해자 스캔 

### 악성 코드 계보

Mirai는 BASHLITE의 진화. BASHLITE는 기본 인증 정보를 무작위 대입하여(brute forcing) 리눅스 장치를 감염시킨 DDoS 악성코드 제품군. BASHLITE보다 더 많은 사용자 이름-암호 쌍을 사용하고 빠르고 stateless한 스케닝 모듈을 사용하여 취약한 장치를 더 효율적으로 식별 

## 방법론

미라이 봇넷을 분석하기 위한 다각적인 데이터 수집 전략. 

### Network Telescope

미라이의 무차별적이고 신속한 스캐닝을 추적하기에 적합. 7개월간 470만개의 IP주소로 구성된 네트워크 텔레스코프에 들어오는 모든 네트워크 요청을 모니터링.

분당 269,000개의 IP 주소로부터 110만개의 패킷 수신. 미라이 트래픽을 배경 복사 및 다른 스캐닝 활동과 구별하기 위해 stateless 스캐닝의 부산물을 기반으로 미라이 프로브를 고유하게 식별.  

이 때 부산물은 모든 프로브의 TCP 시퀀스 번호가 목적지 IP 주소와 동일. 원래는 무작위 32비트 정수라서 우연히 발생할 확률은 매우 낮음. 5540만 개의 IP 주소로부터 1162억 개의 미라이 프로브를 관찰. 미라이 출현 전에는 이런 스캔을 수행하는 IP 주소는 3개만 관찰됐음 그 중 두개는 다섯개의 패킷을 생성했고. 세번째 주소는 정기적인 TCP/443 스캔을 수행하는 Team Cymru에 속함  

시간에 따른 스캐닝하는 IP 주소를 단순히 카운트하는 건 DHCP 변동 때문에 크기를 확인하는 데 좋은 지표가 아님.  그래서 매 시간 시작 시점에 능동적으로 스캐닝하고 있는 호스트의 수를 고려하여 봇넷의 크기를 추적  

하나의 IP 주소에서 나온 패킷들을 temporal window(시간 창) 내에서 논리적인 스캔으로 묶음. 초당 최소 5개 이상의 패킷 속도로 IPv4 주소 공간을 표적으로 삼는 스캔을 식별했으며 20분동안 비활성되면 해당 스캔을 종료. Maxmind를 사용하여 IP들의 지리적 위치를 파악