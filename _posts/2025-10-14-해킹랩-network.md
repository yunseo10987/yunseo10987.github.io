---
title: "[2025-10-14] 가상 환경 구축"
excerpt: "네트워크 설정"

categories:
  - Lab
tags:
  - [NetWork]

permalink: /Lab/[2025-10-14] 가상 환경 구축/

toc: true
toc_sticky: true

date: 2025-10-14
last_modified_at: 2025-10-14
---

## 🦥 본문

## IP 주소

LAN : 한정된 영역의 네트워크

- 사설 IP 주소 사용

WAN : 넓은 영역의 네트워크

- 공인 IP 주소 사용

NAT : 사설 IP 주소와 공인 IP 주소를 1대 1로 대응하게 하는 기능

- 1대 1 대응이므로 인터넷에 접속할 수 있는 단말이 1대로 한정

NAPT : 포트 번호를 이용해 1개의 공인 IP 주소를 여러 사설 IP 주소가 사용하게 해주는 기능

정적 IP 주소 할당 : 네트워크 어댑터에 IP주소를 수동으로 할당하는 방법. 

- 라우터, NAS, 프린터, 서버 등은 정적 IP 주소 사용

동적 IP 주소 할당 : DHCP를 통해 네트워크 어댑터에 자동으로 IP주소를 할당

### 가상 머신 속 네트워크 종류

- 연결 되지 않음 : 네트워크 어뎁터는 활성화하지만 통신은 되지 않는 모드. 이상 처리를 시험할 때 사용
- NAT
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image.png)
    
    가상 머신 내부 네트워크 → 외부 네트워크
    
    가상 머신 내부 네트워크 → Host 운영체제 
    
    외부 → VM. VM ↔VM 불가
    
- NAT 네트워크
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image-1.png)
    
    NAT + NAT 네트워크 내에 DHCP가 있어서 게스트 운영체제끼리 서로 통신 가능
    
- 브리지 어뎁터
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image-2.png)
    
    Host PC와 동등한 수준의 네트워크 구성. 추가의 IP 할당 필요. 
    
- 내부 네트워크
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image-3.png)
    
    물리 네트워크와는 독립적으로 게스트 운영체제 간 네트워크를 구성하는 모드. 게스트 ↔ 호스트 통신도 불가. DHCP가 없어서 정적 주소 할당 방식 또는 게스트 운영체제 중 하나가 DHCP 서버 역할을 해야 함
    
- 호스트 전용 어댑터
    
    ![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image-4.png)
    
    내부 네트워크 + 호스트 운영체제와 통신 가능. DHCP 기능을 사용 가능하여 호스터 전용 어댑터 설정에서 지정한 IP 주소 사용
    

- 해킹랩 네트워크
    - 목표
        - 가상 내부 네트워크 준비
        - 내부 네트워크 접속 가능 : 취약점 조사를 위함
        - 호스트 운영체제에서 칼리 접속 후 조작.
        - 인터넷 접속 가능 : 검색 혹은 소프트웨어 다운로드 및 업데이트 수행

![image.png](https://yunseo10987.github.io/assets/images/posts_img/2025-10-14%20network/image-5.png)

어댑터 1 

호스트 전용 어댑터로 정적 IP 주소를 할당받는 어댑터. 10.0.0.2로 해킹 실험용 어댑터이다

어댑터 2

NAT로 동적 IP 주소를 할당받는 어댑터. 인터넷과 내부 네트워크의 단말에 접속하는 용도이다.

→ 즉, 내부 네트워크에서 Kali를 통해서만 인터넷에 접속하고 호스트가 접속할 수 있는 네트워크이다

### IP 주소 할당 방법

- 일반적인 IP 주소 할당
    
    `/etc/network/interface` 
    
    - 동적 IP 주소
        
        ```c
        # The loopback network interface
        auto lo
        iface lo inet loopback
        
        # The primary network interface
        auto eth0           //시스템 시작 시 인터페이스 eth0 실행. 
        										//allow-hotplug eth0 : 커널이 네트워크 어댑터를 인식했을 때 실행
        iface eth0 inet dhcp
        ```
        
    - 정적 IP 주소
        
        ```c
        # The loopback network interface
        auto lo
        iface lo inet loopback
        
        # The primary network interface
        auto eth0
        iface eth0 inet static
        address 192.111.1.2
        netmask 255.255.255.0
        gateway 192.111.1.1
        ```
        
    - 설정 반영
        
        ```c
        //auto인 경우
        /etc/init.d/networking restart 
        
        //allow-hotplug인 경우
        ifdown eth0 && ifup eth0
        ```
        
- 2개의 네트워크 어댑터
    - 가상 네트워크 어댑터 추가 및 동적 IP 주소 할당
        
        [VirtualBox] - [파일] - [도구] - [네트워크] - [호스트 전용 네트워크] - [만들기]
        
        [만들어진 어댑터 속성] 
        
        IP 주소 : 10.0.0.1 
        
        DHCP 서버 활성화
        
        DHCP 서버 주소 : 10.0.0.100
        
        주소 한계 : 10.0.0.101 ~ 10.0.0.254
        
        [VirtualBox] - [Kali Linux의 설정] - [네트워크]
        
        어댑터 1 : 호스트 전용 어댑터. 이름은 새로 만든 어댑터의 이름
        
        어댑터 2 : NAT (이때 Kali Linux가 아예 종료된 상태여야 함)
        
    - 정적 IP 주소 할당
        
        ```c
        sudo vi /etc/network/interface
        
        # The primary network interface
        allow-hotplug eth0
        iface eth0 inet static
        address 10.0.0.2
        netmask 255.255.255.0
        
        # The secondary network interface
        allow-hotplug ethl
        iface eth1 inet dhcp
        ```
        
        리눅스 재시작
        
        - 확인 방법
            
            ```c
            ifconfig
            eth0 10.0.0.2
            eth1 10.0.3.15
            
            route 
            -> defualt가 한 줄인지 확인
            
            ping 공유기 IP //물리 네트워크 연결 확인
            ping akademia.info //인터넷 연결 확인
            ping 10.0.0.1 //호스트 네트워크 내의 호스트 운영체제와 연결
            //호스트 운영체제와 ping을 하려면 방화벽 - 파일 및 프린터 공유 ICMPv4-In 을 규칙 사용으로 바꿔야 함
            ```